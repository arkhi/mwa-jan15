<!DOCTYPE html>
<html xmlns='http://www.w3.org/1999/xhtml' lang='en'>
  <head>
    <meta charset='utf-8'/>
    <title>Assignment 3</title>

    <meta name="viewport" content="width=device-width">

    <!-- <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.css" /> -->
    <link rel="stylesheet" href="js/leaflet/leaflet.css" />
    <style>
      body {
        width: 100%;
        padding: 0;
        margin: 0 auto;
        font-family: Verdana, sans-serif;
        color: #333;
        background-color: #fff;
        /* Avoid shift in layout if content gets collapsed. */
        overflow-y: scroll;
      }

      @media all and (min-width:35em){
        body {
          width: 80%;
          max-width: 38em;
        }
      }

      h1,
      h2 {
        padding: .5rem;
        margin: 0;
      }

      h1 {
        font-family: zapfino, cursive;
        font-size: 1.5rem;
        text-align: center;
        color: #fff;
        background-color: #95005e;
      }

      @media all and (min-width:35em){
        h1 {
          border-radius: 0 0 3px 3px;
        }
      }

      h2,
      .can-collapse {
        transition-duration: .2s;
      }

      h2 {
        padding-right: 2em;
        font-size: 1rem;

        transition-property: color, background-color;
      }

      .can-collapse {
        overflow: hidden;
        transition-property: height;
      }

      .collapse-trigger:focus,
      .collapse-trigger:hover {
        background-color: #ddd;
      }

      .collapse-trigger:active {
        background-color: #bbb;
      }

      /* Referencial for the arrow */
      .can-collapse .collapse-trigger {
        position: relative;
      }

      .can-collapse .collapse-trigger::after {
        position: absolute;
        right: .5rem;
        /* Simulate an arrow with borders as "\2bc8" is not well rendered on all devices. */
        border: solid transparent;
        /* .5rem × 2 = font-size */
        border-width: .5rem 0 .5rem .5em;
        border-left-color: #333;
        content: '';
        /* More or less the centroid of the arrow */
        transform-origin: 25% center;
        transform: rotate(0);
        transition: transform .2s;
      }

      .open .collapse-trigger::after {
        transform: rotate(90deg);
      }

      .collapse-target {
        padding: 0 .5rem;
      }

      .can-click {
        cursor: pointer;
      }

      .searching-location {
        background-color: #f00;
      }

      /* form */

      .add-entry {
        border: solid #999;
        border-width: 1px 0;
        text-transform: uppercase;
        background-color: #f9baf5;
      }

      /* map */

      #map.has-content {
        z-index: 0;
        height: 300px;
      }

      .entry-location {
        display: none;
      }

      /* debug */

      #feedbacks {
        position: fixed;
        top: 0;
        right: 0;
        left: 3em;
        z-index: 1;
        padding-left: .5em;
        border-left: dotted 2px #999;
      }

      .feedback-entry {
        padding: .5em 1em;
        font-weight: bold;
        background-color: #dfefe1;
      }

      .feedback-entry + .feedback-entry {
        margin-top: .5em;
      }

      .feedback-error {
        background-color: #ffcfcf;
      }

      .feedback-info {
        background-color: #cfdeff;
      }

      .feedback-warning {
        background-color: #ffffcf;
      }

      .close-all {
        position: absolute;
        top: 0;
        right: 100%;
        padding: 0.5rem 0.75rem;
        font-size: 2rem;
        font-weight: bold;
        color: #999;
        background-color: #fff;
      }

      .close-all:hover {
        color: #000;
      }

      /* debug */

      .debug .can-collapse::before {
        position: absolute;
        left: 70%;
        content: attr(id);
      }

      #dev-actions {
        display: none;
      }

      .debug #dev-actions {
        display: block;
      }

      @media all and (min-width:35em){
        #dev-debug {
          position: fixed;
          top: 0;
          right: 80%;
          left: 0;
        }
      }
    </style>
  </head>
  <body>
    <h1 class="toggle-all">My Diary Entries</h1>
    <div id="map"></div>

    <section class="entries">
      <form id="add-entry" class="can-collapse">
        <h2 class="add-entry collapse-trigger">Add entry</h2>

        <div class="collapse-target">
          <div class="block">
            <label for="title">Title</label>
            <input id="title" name="title" type="text" required>
          </div>
          
          <div class="block">
            <label for="description">Description</label>
            <textarea id="description" name="description" cols="30" rows="10" required></textarea>
          </div>
          
          <div class="block">
            <input id="location" name="location" type="checkbox" value="ok">
            <label for="location">Show my present location.</label>
          </div>
          
          <div class="block">
            <button id="post-entry" name="submit" type="submit">Post entry</button>
          </div>
        </div>
      </form>
    </section>

    <div id="dev-actions">
      <hr>
      <button class="action" data-action="clearLocalStorage">clear local storage</button>
      <button class="action" data-action="populate">Populate with dummy entries</button>
      <button class="action" data-action="listEntries">list entries</button>
    </div>

    <script id="tpl-entry" type="text/x-jsrender">
      <article id="entry-{{:entryID}}" class="entry can-collapse">
        <h2 class="collapse-trigger">{{:title}}</h2>
        <div class="collapse-target">
          <div class="actions">
            <a class="action" data-action="delete" href="?/delete/{{url:entryID}}" title="delete “{{attr:title}}”">delete</a>
            <a class="action" data-action="edit" href="?/edit/{{url:entryID}}" title="edit “{{attr:title}}”">edit</a>
          </div>
          {{:description}}
        </div>
      </article>
    </script>

    <script id="tpl-edit-entry" type="text/x-jsrender">
      <form id="edit-entry-{{:entryID}}">
        <h2 class="collapse-trigger">
          <input id="title-{{:entryID}}" name="title[{{:entryID}}]" type="text" required value="{{:title}}" />
        </h2>
        <div class="collapse-target">
          <textarea id="description-{{:entryID}}" name="description[{{:entryID}}]"
                    cols="30" rows="10" required>{{:description}}</textarea>
          
          <div class="block">
            <input id="location-{{:entryID}}" name="location[{{:entryID}}]" type="checkbox" value="ok">
            <label for="location-{{:entryID}}">Update to my present location.</label>
          </div>
          
          <div class="actions">
            <button class="action" data-action="submit" href="?/delete/{{url:entryID}}" title="delete “{{attr:title}}”">submit</button>
            <button type="reset">reset</button>
          </div>
        </div>
      </form>
    </script>

    <script id="tpl-feedback-entry" type="text/x-jsrender">
      <div class="feedback-entry feedback-{{:type}} can-click" data-action="closeFeedback">
        {{:msg}}
      </div>
    </script>

    <!-- <script src="http://code.jquery.com/jquery-2.1.3.min.js"></script> -->
    <!-- <script src="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.js"></script> -->
    <script src="js/jsrender.min.js"></script>
    <script src="js/jquery-1.11.2.min.js"></script>
    <script src="js/leaflet/leaflet.js"></script>
    <script src="js/myLittleDiary.js"></script>

    <script>
      myLittleDiary.cfg.debug = true;
    </script>
  </body>
</html>

